import{s as se,n as z,o as ce}from"../chunks/CHokvJ-H.js";import{S as re,i as pe,d as Q,a as de,b as le,c as me,j as ue,e as he}from"../chunks/DjQ7aYyS.js";import{ac as fe,ad as Z,g as y,V as E,Q as ye,X as G,W as ge,ae as Ee,af as be,ag as we,o as K,ah as je,x as Oe,w as Te,E as Pe}from"../chunks/5ecB4tJ3.js";const R={type:"change"},I={type:"start"},Y={type:"end"};class Me extends fe{constructor(c,u){super();const e=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=c,this.domElement=u,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Z.ROTATE,MIDDLE:Z.DOLLY,RIGHT:Z.PAN},this.target=new y;const d=1e-6,g=new y;let O=1,r=n.NONE,m=n.NONE,k=0,M=0,v=0;const a=new y,h=new E,p=new E,X=new y,f=new E,T=new E,w=new E,P=new E,i=[],C={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const t=e.domElement.getBoundingClientRect(),o=e.domElement.ownerDocument.documentElement;e.screen.left=t.left+window.pageXOffset-o.clientLeft,e.screen.top=t.top+window.pageYOffset-o.clientTop,e.screen.width=t.width,e.screen.height=t.height};const x=function(){const t=new E;return function(s,l){return t.set((s-e.screen.left)/e.screen.width,(l-e.screen.top)/e.screen.height),t}}(),L=function(){const t=new E;return function(s,l){return t.set((s-e.screen.width*.5-e.screen.left)/(e.screen.width*.5),(e.screen.height+2*(e.screen.top-l))/e.screen.width),t}}();this.rotateCamera=function(){const t=new y,o=new ye,s=new y,l=new y,b=new y,j=new y;return function(){j.set(p.x-h.x,p.y-h.y,0);let N=j.length();N?(a.copy(e.object.position).sub(e.target),s.copy(a).normalize(),l.copy(e.object.up).normalize(),b.crossVectors(l,s).normalize(),l.setLength(p.y-h.y),b.setLength(p.x-h.x),j.copy(l.add(b)),t.crossVectors(j,a).normalize(),N*=e.rotateSpeed,o.setFromAxisAngle(t,N),a.applyQuaternion(o),e.object.up.applyQuaternion(o),X.copy(t),v=N):!e.staticMoving&&v&&(v*=Math.sqrt(1-e.dynamicDampingFactor),a.copy(e.object.position).sub(e.target),o.setFromAxisAngle(X,v),a.applyQuaternion(o),e.object.up.applyQuaternion(o)),h.copy(p)}}(),this.zoomCamera=function(){let t;r===n.TOUCH_ZOOM_PAN?(t=k/M,k=M,e.object.isPerspectiveCamera?a.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=G.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),O!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(t=1+(T.y-f.y)*e.zoomSpeed,t!==1&&t>0&&(e.object.isPerspectiveCamera?a.multiplyScalar(t):e.object.isOrthographicCamera?(e.object.zoom=G.clamp(e.object.zoom/t,e.minZoom,e.maxZoom),O!==e.object.zoom&&e.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),e.staticMoving?f.copy(T):f.y+=(T.y-f.y)*this.dynamicDampingFactor)},this.panCamera=function(){const t=new E,o=new y,s=new y;return function(){if(t.copy(P).sub(w),t.lengthSq()){if(e.object.isOrthographicCamera){const b=(e.object.right-e.object.left)/e.object.zoom/e.domElement.clientWidth,j=(e.object.top-e.object.bottom)/e.object.zoom/e.domElement.clientWidth;t.x*=b,t.y*=j}t.multiplyScalar(a.length()*e.panSpeed),s.copy(a).cross(e.object.up).setLength(t.x),s.add(o.copy(e.object.up).setLength(t.y)),e.object.position.add(s),e.target.add(s),e.staticMoving?w.copy(P):w.add(t.subVectors(P,w).multiplyScalar(e.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!e.noZoom||!e.noPan)&&(a.lengthSq()>e.maxDistance*e.maxDistance&&(e.object.position.addVectors(e.target,a.setLength(e.maxDistance)),f.copy(T)),a.lengthSq()<e.minDistance*e.minDistance&&(e.object.position.addVectors(e.target,a.setLength(e.minDistance)),f.copy(T)))},this.update=function(){a.subVectors(e.object.position,e.target),e.noRotate||e.rotateCamera(),e.noZoom||e.zoomCamera(),e.noPan||e.panCamera(),e.object.position.addVectors(e.target,a),e.object.isPerspectiveCamera?(e.checkDistances(),e.object.lookAt(e.target),g.distanceToSquared(e.object.position)>d&&(e.dispatchEvent(R),g.copy(e.object.position))):e.object.isOrthographicCamera?(e.object.lookAt(e.target),(g.distanceToSquared(e.object.position)>d||O!==e.object.zoom)&&(e.dispatchEvent(R),g.copy(e.object.position),O=e.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){r=n.NONE,m=n.NONE,e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.up.copy(e.up0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),a.subVectors(e.object.position,e.target),e.object.lookAt(e.target),e.dispatchEvent(R),g.copy(e.object.position),O=e.object.zoom};function H(t){e.enabled!==!1&&(i.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",A),e.domElement.addEventListener("pointerup",D)),ie(t),t.pointerType==="touch"?te(t):$(t))}function A(t){e.enabled!==!1&&(t.pointerType==="touch"?oe(t):J(t))}function D(t){e.enabled!==!1&&(t.pointerType==="touch"?ne(t):ee(),W(t),i.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",A),e.domElement.removeEventListener("pointerup",D)))}function U(t){W(t)}function _(t){e.enabled!==!1&&(window.removeEventListener("keydown",_),m===n.NONE&&(t.code===e.keys[n.ROTATE]&&!e.noRotate?m=n.ROTATE:t.code===e.keys[n.ZOOM]&&!e.noZoom?m=n.ZOOM:t.code===e.keys[n.PAN]&&!e.noPan&&(m=n.PAN)))}function V(){e.enabled!==!1&&(m=n.NONE,window.addEventListener("keydown",_))}function $(t){if(r===n.NONE)switch(t.button){case e.mouseButtons.LEFT:r=n.ROTATE;break;case e.mouseButtons.MIDDLE:r=n.ZOOM;break;case e.mouseButtons.RIGHT:r=n.PAN;break}const o=m!==n.NONE?m:r;o===n.ROTATE&&!e.noRotate?(p.copy(L(t.pageX,t.pageY)),h.copy(p)):o===n.ZOOM&&!e.noZoom?(f.copy(x(t.pageX,t.pageY)),T.copy(f)):o===n.PAN&&!e.noPan&&(w.copy(x(t.pageX,t.pageY)),P.copy(w)),e.dispatchEvent(I)}function J(t){const o=m!==n.NONE?m:r;o===n.ROTATE&&!e.noRotate?(h.copy(p),p.copy(L(t.pageX,t.pageY))):o===n.ZOOM&&!e.noZoom?T.copy(x(t.pageX,t.pageY)):o===n.PAN&&!e.noPan&&P.copy(x(t.pageX,t.pageY))}function ee(){r=n.NONE,e.dispatchEvent(Y)}function F(t){if(e.enabled!==!1&&e.noZoom!==!0){switch(t.preventDefault(),t.deltaMode){case 2:f.y-=t.deltaY*.025;break;case 1:f.y-=t.deltaY*.01;break;default:f.y-=t.deltaY*25e-5;break}e.dispatchEvent(I),e.dispatchEvent(Y)}}function te(t){switch(B(t),i.length){case 1:r=n.TOUCH_ROTATE,p.copy(L(i[0].pageX,i[0].pageY)),h.copy(p);break;default:r=n.TOUCH_ZOOM_PAN;const o=i[0].pageX-i[1].pageX,s=i[0].pageY-i[1].pageY;M=k=Math.sqrt(o*o+s*s);const l=(i[0].pageX+i[1].pageX)/2,b=(i[0].pageY+i[1].pageY)/2;w.copy(x(l,b)),P.copy(w);break}e.dispatchEvent(I)}function oe(t){switch(B(t),i.length){case 1:h.copy(p),p.copy(L(t.pageX,t.pageY));break;default:const o=ae(t),s=t.pageX-o.x,l=t.pageY-o.y;M=Math.sqrt(s*s+l*l);const b=(t.pageX+o.x)/2,j=(t.pageY+o.y)/2;P.copy(x(b,j));break}}function ne(t){switch(i.length){case 0:r=n.NONE;break;case 1:r=n.TOUCH_ROTATE,p.copy(L(t.pageX,t.pageY)),h.copy(p);break;case 2:r=n.TOUCH_ZOOM_PAN;for(let o=0;o<i.length;o++)if(i[o].pointerId!==t.pointerId){const s=C[i[o].pointerId];p.copy(L(s.x,s.y)),h.copy(p);break}break}e.dispatchEvent(Y)}function q(t){e.enabled!==!1&&t.preventDefault()}function ie(t){i.push(t)}function W(t){delete C[t.pointerId];for(let o=0;o<i.length;o++)if(i[o].pointerId==t.pointerId){i.splice(o,1);return}}function B(t){let o=C[t.pointerId];o===void 0&&(o=new E,C[t.pointerId]=o),o.set(t.pageX,t.pageY)}function ae(t){const o=t.pointerId===i[0].pointerId?i[1]:i[0];return C[o.pointerId]}this.dispose=function(){e.domElement.removeEventListener("contextmenu",q),e.domElement.removeEventListener("pointerdown",H),e.domElement.removeEventListener("pointercancel",U),e.domElement.removeEventListener("wheel",F),e.domElement.removeEventListener("pointermove",A),e.domElement.removeEventListener("pointerup",D),window.removeEventListener("keydown",_),window.removeEventListener("keyup",V)},this.domElement.addEventListener("contextmenu",q),this.domElement.addEventListener("pointerdown",H),this.domElement.addEventListener("pointercancel",U),this.domElement.addEventListener("wheel",F,{passive:!1}),window.addEventListener("keydown",_),window.addEventListener("keyup",V),this.handleResize(),this.update()}}function ve(S){let c;return{c(){c=he("div"),this.h()},l(u){c=me(u,"DIV",{id:!0}),ue(c).forEach(Q),this.h()},h(){le(c,"id","container")},m(u,e){de(u,c,e)},p:z,i:z,o:z,d(u){u&&Q(c)}}}function xe(S){let c,u,e,n,d,g;ce(()=>{const m=document.getElementById("container");c=new ge(50,window.innerWidth/window.innerHeight,1,5e3),c.position.set(0,0,1e3),u=new Ee,e=new be,e.setSize(window.innerWidth,window.innerHeight),m.appendChild(e.domElement),d=document.createElement("video"),d.src="/test.mp4",d.loop=!0,d.muted=!0,d.playsInline=!0,d.addEventListener("error",a=>{console.error("Video error:",d.error)}),d.addEventListener("loadeddata",()=>{console.log("Video loaded successfully")}),d.load(),d.play().catch(a=>console.error("Play failed:",a)),console.log("videoElement",d),g=new we(d),g.minFilter=K,g.magFilter=K;const k=new je(480,360),M=new Oe({map:g,side:Te}),v=new Pe(k,M);u.add(v),n=new Me(c,e.domElement),n.rotateSpeed=4,window.addEventListener("resize",O),r()});function O(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)}function r(){requestAnimationFrame(r),n.update(),e.render(u,c)}return[]}class Ne extends re{constructor(c){super(),pe(this,c,xe,ve,se,{})}}export{Ne as component};
