import{s as K,c as R,o as Q,e as tt,d as et}from"../chunks/CHokvJ-H.js";import{S as ot,i as nt,d as x,B as I,w as S,v as M,a as _,D as P,l as at,F as it,G as rt,b as k,k as D,c as E,j as H,E as T,s as B,e as L,C as z,h as A,g as st}from"../chunks/DjQ7aYyS.js";import{g as f,ap as lt,i as G,R as ct,aq as dt,w as X,E as Z,z as pt,B as V,ah as ut,x as mt,f as W,af as ht,ar as gt}from"../chunks/5ecB4tJ3.js";import{r as yt,l as ft,V as wt,s as xt,c as bt,d as vt,e as _t,b as kt,F as St,L as Mt,A as O,S as Dt,g as N,f as Bt}from"../chunks/BSkMa5_B.js";import{G as At}from"../chunks/Br_SFkwl.js";import{V as Et}from"../chunks/UBz5w6NV.js";import{i as Lt}from"../chunks/SzQcKhoD.js";function It(l,a){const o=new At,p=n=>{o.load("/seagull.glb",c=>{const r=c.scene.children[0];r.scale.set(.9,.9,.9),r.position.set(10,9,0);const d={angle:n.startAngle,radius:n.radius,rotationSpeed:n.rotationSpeed,height:n.flyHeight||a.height*30,centerPoint:new f(0,n.flyHeight||a.height*4,0),lastDirection:new f,rotationOffset:.2,zRotation:1,xRotation:.733},g=new lt(r),s=c.animations;if(s.length>0){const e=g.clipAction(s[0]);e.timeScale=99e-5,e.play()}l.add({name:`bird_${n.id}`,object:r,update:e=>{d.angle+=e*d.rotationSpeed;const t=d.centerPoint.x+d.radius*Math.cos(d.angle),u=d.centerPoint.z+d.radius*Math.sin(d.angle);let w=d.centerPoint.y+Math.sin(d.angle*.5)*40;w=Math.max(w,37);const J=r.position.clone();r.position.set(t,w,u);const U=r.position.clone().sub(J).normalize();U.lengthSq()>0&&d.lastDirection.copy(U),r.lookAt(r.position.clone().add(d.lastDirection)),r.rotateY(d.rotationOffset*Math.PI*2),r.rotateZ(d.zRotation*Math.PI*2),r.rotateX(d.xRotation*Math.PI*2),g.update(e)}})})};p({id:1,startAngle:0,radius:50,rotationSpeed:5e-4,flyHeight:40}),p({id:2,startAngle:Math.PI,radius:65,rotationSpeed:4e-4,flyHeight:60}),p({id:3,startAngle:Math.PI/2,radius:105,rotationSpeed:26e-5,flyHeight:80});const i=document.createElement("button");i.innerHTML="üîä",i.style.position="absolute",i.style.bottom="27px",i.style.left="12.3%",i.style.color="white",i.style.zIndex="1000",i.style.fontSize="1.7rem",document.body.appendChild(i);const h=new Audio("/seagull.mp3");h.loop=!0,i.addEventListener("click",()=>{h.paused?(h.currentTime=0,h.play().catch(n=>console.error("Audio play failed:",n)),i.innerHTML="üñï"):(h.pause(),i.innerHTML="üîä")})}const Pt=.001,q=.08,Tt=3.7,zt=.3,$=31e3,$t=Math.PI*2,C=5,v={width:64*2,depth:107*2},b={rightStrip:{x:[v.width/2-10,v.width/2],z:[-214/2,v.depth/2]},bottomStrip:{x:[-128/2,v.width/2],z:[-214/2,-214/2+10]}};function Ct(l,a){const o=l>=b.rightStrip.x[0]&&l<=b.rightStrip.x[1]&&a>=b.rightStrip.z[0]&&a<=b.rightStrip.z[1],p=l>=b.bottomStrip.x[0]&&l<=b.bottomStrip.x[1]&&a>=b.bottomStrip.z[0]&&a<=b.bottomStrip.z[1];return o||p}function Ht(l,a){const o=q*.5,p=.1,i=Tt+Math.random()*zt,h=Math.random()*$t,n=new f(Math.sin(h),0,-Math.cos(h)),c=Math.random()*Math.PI*2,r=new f(Math.sin(c),0,-Math.cos(c)),d=new f().addVectors(l,new f().copy(n).multiplyScalar(q/2)),g=new f().addVectors(l,new f().copy(n).multiplyScalar(-.08/2)),s=new f().addVectors(l,new f().copy(n).multiplyScalar(o/2)),e=new f().addVectors(l,new f().copy(n).multiplyScalar(-.04/2)),t=new f().addVectors(l,new f().copy(r).multiplyScalar(p));return s.y+=i/2,e.y+=i/2,t.y+=i,{positions:[...d.toArray(),...g.toArray(),...e.toArray(),...s.toArray(),...t.toArray()],indices:[a,a+1,a+2,a,a+2,a+3,a+3,a+2,a+4]}}function Rt(){const l=new Float32Array($*C*3),a=new Uint32Array($*12),o=new Float32Array($*C*2);let p=0,i=0,h=0,n=0;for(;n<$;){const r=Math.random()*v.width-v.width/2,d=Math.random()*v.depth-v.depth/2;if(Ct(r,d)){const g=new f(r,0,d),s=Ht(g,n*C);s.positions.forEach(e=>{l[p++]=e}),s.indices.forEach(e=>{a[h++]=e});for(let e=0;e<C*2;e++)o[i++]=Math.random();n++}}const c=new pt;return c.setAttribute("position",new V(l,3)),c.setAttribute("uv",new V(o,2)),c.setIndex(new V(a,1)),c.computeVertexNormals(),c}function Vt(l,a){const o={vert:`
      varying vec2 vUv;
      uniform float time;
      uniform float windSpeed;
      
      void main() {
        vUv = uv;
        vec3 pos = position;
  
        // use windSpeed uniform for movement
        float wind = sin(time * windSpeed + position.x * 0.5 + position.z * 0.5) * 0.05;
  
        pos.x += wind * pow(position.y, 2.0);
        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
      }
    `,frag:`
      varying vec2 vUv;
      uniform sampler2D grassTexture;
      uniform float time;
      
      void main() {
        vec4 grassColor = texture2D(grassTexture, vUv);
        gl_FragColor = grassColor;
      }
    `},p=new G().load("/grass.jpg");p.wrapS=p.wrapT=ct,p.repeat.set(10,10);const i=new dt({uniforms:{grassTexture:{value:p},time:{value:0},windSpeed:{value:Pt}},vertexShader:o.vert,fragmentShader:o.frag,side:X}),h=Rt(),n=new Z(h,i);n.position.y=-3,l.add({name:"grass",object:n,update:function(c){i.uniforms.time.value+=c}})}const Ft=(l,a,o,p)=>{const h=new G().load("/x.webp");let n=0,c=0;for(let u=0;u<o.length;u++)for(let w=0;w<o[u].length;w++)o[u][w]===1&&(n=(w-o[u].length/2)*(a.width/o[u].length),c=(u-o.length/2)*(a.depth/o.length));const r=new ut(11,11),d=new mt({map:h,transparent:!0,side:X}),g=new Z(r,d),s=new W;s.makeRotationX(-Math.PI/2),s.multiply(new W().makeRotationZ(Math.PI/2)),s.setPosition(n,-6/2+1.1,c),g.applyMatrix4(s);const e={name:"mark",object:g,gui:[[g.position,"x",-10,10,1,"x"],[g.position,"y",-10,10,1,"y"],[g.position,"z",-10,10,1,"z"]]};return l.add(e),u=>{const w=g.position.x,j=g.position.z;Math.abs(u.x-w)<1&&Math.abs(u.z-j)<1&&console.log("Player is above the mark")}};let m,F;const y={width:64*2,depth:107*2,height:4*1.5,thickness:1,wallHeight:36,player:{x:-64*.3,y:1.5,z:-107*.46,look:{x:0,y:-.3}}},Gt=[[0,0,0],[0,1,0],[0,0,0]],jt=(l,a)=>{console.log("initRum called with canvas:",l),m=new wt(window,l),m.run();const o=new ht({canvas:l});o.setSize(window.innerWidth,window.innerHeight),o.xr.enabled=!0,navigator.xr&&navigator.xr.isSessionSupported("immersive-vr").then(n=>{if(n){const c=Et.createButton(o);document.body.appendChild(c)}}),m.renderer=o;const p=new G,i=xt(y);m.add(i),m.input.onDown.c=n=>{m.gui.show(m.gui._hidden)},m.input.onDown.h=n=>{m.hudEnabled=!m.hudEnabled},m.add({name:"world",unremovable:!0});{var h={name:"settings",unremovable:!0};m.add(h)}m.add({name:"camera",unremovable:!0});{const n=Ft(m,y,Gt);F=bt(m,{position:{x:y.player.x,y:y.player.y,z:y.player.z},look:{x:y.player.look.x,y:y.player.look.y},room:{width:y.width,depth:y.depth},onUpdate:c=>{n(c)}}),vt(m,F)}_t(m,{width:y.width,depth:y.depth,height:y.height,thickness:y.thickness,wallHeight:y.wallHeight,walls:{west:!0,north:!0,east:!1,south:!1}},p);{const n=new gt,c=n.load(["/skybox/Daylight_Box_Right.jpg","/skybox/Daylight_Box_Left.jpg","/skybox/Daylight_Box_Top.jpg","/skybox/Daylight_Box_Bottom.jpg","/skybox/Daylight_Box_Front.jpg","/skybox/Daylight_Box_Back.jpg"]),r=n.load(["/skybox-night/Daylight_Box_Right.jpg","/skybox-night/Daylight_Box_Left.jpg","/skybox-night/Daylight_Box_Top.jpg","/skybox-night/Daylight_Box_Bottom.jpg","/skybox-night/Daylight_Box_Front.jpg","/skybox-night/Daylight_Box_Back.jpg"]);let d=!0;const g=m.renderer.domElement,s=document.createElement("button");s.textContent="üåô",s.style.position="absolute",s.style.bottom="20px",s.style.left="20%",s.style.transform="translateX(-50%)",s.style.width="50px",s.style.height="50px",s.style.borderRadius="50%",s.style.fontSize="27px",s.style.color="white",s.style.cursor="pointer",s.style.zIndex="1000",s.style.backgroundColor="rgba(0, 0, 0, 0)",g.parentElement.style.position="relative",g.parentElement.appendChild(s),m.scene.background=c;const e=()=>{d=!d,d?(s.textContent="‚òÄÔ∏è",m.scene.background=c,m.scene.traverse(t=>{t.material&&t.material.color&&t.userData.originalColor&&t.material.color.copy(t.userData.originalColor)}),m.scene.traverse(t=>{t.type==="AmbientLight"&&(t.intensity=.2),t.type==="DirectionalLight"&&(t.intensity=.2)})):(s.textContent="‚òÄÔ∏è",m.scene.background=r,m.scene.traverse(t=>{t.material&&t.material.color&&(t.userData.originalColor||(t.userData.originalColor=t.material.color.clone()),t.material.color.multiplyScalar(.3))}),m.scene.traverse(t=>{t.type==="AmbientLight"&&(t.intensity=.1),t.type==="DirectionalLight"&&(t.intensity=.1)}))};s.addEventListener("click",e),m.input.onDown.n=e}kt(m,p,a,y),It(m,y),Vt(m),setInterval(()=>{},2e3)},Ut=(l,a)=>{jt(l,a)},Wt=()=>{ft(m,F,y)},Y=()=>{console.log("removeSmileyFaceWrapper"),yt(m)};function Nt(l){let a,o,p,i,h,n,c,r,d=`<a class="px-11 flex items-center gap-1" href="/stappen/20" data-sveltekit-reload="">till St√§ppen
          <svg class="w-9 h-9" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-width="1.5" d="M14 6l6 6-6 6"></path></svg></a>`,g,s;return i=new Dt({props:{loadSmiley:Wt,removeSmiley:Y}}),n=new O({}),{c(){a=L("div"),o=L("nav"),p=L("div"),z(i.$$.fragment),h=B(),z(n.$$.fragment),c=B(),r=L("div"),r.innerHTML=d,this.h()},l(e){a=E(e,"DIV",{class:!0});var t=H(a);o=E(t,"NAV",{class:!0});var u=H(o);p=E(u,"DIV",{class:!0});var w=H(p);T(i.$$.fragment,w),w.forEach(x),h=D(u),T(n.$$.fragment,u),c=D(u),r=E(u,"DIV",{class:!0,"data-svelte-h":!0}),st(r)!=="svelte-hgmj4f"&&(r.innerHTML=d),u.forEach(x),t.forEach(x),this.h()},h(){k(p,"class","flex space-x-2 ml-11"),k(r,"class","text-white bg-gradient-to-r from-green-500 to-green-700 font-bold text-xl py-7 left-0"),k(o,"class","flex space-x-[20rem] justify-between w-full items-center"),k(a,"class",g="fixed backdrop-blur-lg bottom-0 w-full z-50 flex items-center justify-between border-t-[1px] border-white/20 "+(l[1]?"block":"hidden")+" md:block")},m(e,t){_(e,a,t),A(a,o),A(o,p),P(i,p,null),A(o,h),P(n,o,null),A(o,c),A(o,r),s=!0},p(e,t){(!s||t&2&&g!==(g="fixed backdrop-blur-lg bottom-0 w-full z-50 flex items-center justify-between border-t-[1px] border-white/20 "+(e[1]?"block":"hidden")+" md:block"))&&k(a,"class",g)},i(e){s||(M(i.$$.fragment,e),M(n.$$.fragment,e),s=!0)},o(e){S(i.$$.fragment,e),S(n.$$.fragment,e),s=!1},d(e){e&&x(a),I(i),I(n)}}}function qt(l){let a,o,p,i,h,n,c,r,d,g,s,e=!l[2]&&Nt(l);return i=new St({}),n=new Mt({}),r=new O({}),{c(){e&&e.c(),a=B(),o=L("canvas"),p=B(),z(i.$$.fragment),h=B(),z(n.$$.fragment),c=B(),z(r.$$.fragment),this.h()},l(t){e&&e.l(t),a=D(t),o=E(t,"CANVAS",{class:!0}),H(o).forEach(x),p=D(t),T(i.$$.fragment,t),h=D(t),T(n.$$.fragment,t),c=D(t),T(r.$$.fragment,t),this.h()},h(){k(o,"class","w-full h-full fixed top-0 left-0")},m(t,u){e&&e.m(t,u),_(t,a,u),_(t,o,u),l[7](o),_(t,p,u),P(i,t,u),_(t,h,u),P(n,t,u),_(t,c,u),P(r,t,u),d=!0,g||(s=at(o,"click",it(rt(l[3]))),g=!0)},p(t,[u]){t[2]||e.p(t,u)},i(t){d||(M(e),M(i.$$.fragment,t),M(n.$$.fragment,t),M(r.$$.fragment,t),d=!0)},o(t){S(e),S(i.$$.fragment,t),S(n.$$.fragment,t),S(r.$$.fragment,t),d=!1},d(t){t&&(x(a),x(o),x(p),x(h),x(c)),e&&e.d(t),l[7](null),I(i,t),I(n,t),I(r,t),g=!1,s()}}}function Xt(l,a,o){let p,i,h;R(l,N,e=>o(9,p=e)),R(l,Bt,e=>o(6,i=e)),R(l,Lt,e=>o(1,h=e));let{data:n}=a,c,r;const d=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),g=async e=>{await c.requestPointerLock({unadjustedMovement:!0})};Q(()=>{Ut(c,n.artworks),o(5,r=new Audio(i)),r.addEventListener("ended",()=>{Y()}),tt(N,p=!0,p)});function s(e){et[e?"unshift":"push"](()=>{c=e,o(0,c)})}return l.$$set=e=>{"data"in e&&o(4,n=e.data)},l.$$.update=()=>{l.$$.dirty&96&&r&&o(5,r.src=i,r)},[c,h,d,g,n,r,i,s]}class ee extends ot{constructor(a){super(),nt(this,a,Xt,qt,K,{data:4})}}export{ee as component};
